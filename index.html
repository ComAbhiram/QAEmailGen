<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Royal Email Template Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="images/logo.png" alt="Royal Logo">
            <div class="nav">
                <a href="https://intersmartqa.github.io/QATabs/" target="_blank">QA Tabs</a>
                <button onclick="showAdminLogin()">Admin Access</button>
            </div>
        </div>
        <div class="dashboard">
            <div class="mode-toggle">
                <button onclick="switchMode('public')" id="publicModeBtn">Public Mode</button>
                <button onclick="switchMode('admin')" id="adminModeBtn" disabled>Admin Mode</button>
            </div>
            <div class="public-section active" id="publicSection">
                <h2>Generate Royal Email</h2>
                <div class="template-list" id="publicTemplateList"></div>
            </div>
            <div class="admin-section" id="adminSection">
                <h2>Manage Royal Templates</h2>
                <div class="template-list" id="adminTemplateList"></div>
                <button class="add-template-btn" onclick="startNewTemplate()">Add New Template</button>
                <div class="template-form" id="templateForm" style="display: none;">
                    <h3>Create/Edit Template</h3>
                    <label>Template Name</label>
                    <input type="text" id="templateName" required>
                    <label>Message Body (use plain text, insert fields as {field}, use HTML for tables)</label>
                    <textarea id="messageBody" rows="10" required></textarea>
                    <label>Fields to Replace (add one by one in {field} format, e.g., {RecipientName})</label>
                    <div class="field-input">
                        <input type="text" id="fieldInput" placeholder="e.g., {RecipientName}">
                        <button onclick="addField()">Add Field</button>
                    </div>
                    <div id="fieldList" class="field-list"></div>
                    <button onclick="saveTemplate()">Save Template</button>
                    <button onclick="cancelTemplate()">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal" id="adminLoginModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeAdminLogin()">×</button>
            <h3>Admin Login</h3>
            <input type="password" id="adminPassword" placeholder="Enter password">
            <button onclick="loginAdmin()">Login</button>
            <button onclick="closeAdminLogin()">Cancel</button>
        </div>
    </div>
    <div class="modal" id="templateFieldsModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeTemplateFieldsModal()">×</button>
            <h3>Fill Template Fields</h3>
            <div class="modal-scroll">
                <div id="templateFieldsForm" class="template-form"></div>
                <div class="modal-actions">
                    <button onclick="submitTemplateFields()">Submit</button>
                    <button onclick="closeTemplateFieldsModal()">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal" id="generatedEmailModal">
        <div class="modal-content generated-email">
            <button class="close-btn" onclick="closeGeneratedEmailModal()">×</button>
            <h3>Generated Email</h3>
            <div class="modal-scroll">
                <div id="generatedEmailContent" class="generated-email-content"></div>
                <div class="modal-actions">
                    <button onclick="copyEmailContent()">Copy to Clipboard</button>
                    <button onclick="closeGeneratedEmailModal()">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Firebase SDK (Legacy versions for global firebase variable) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="script.js"></script>
</body>
</html>
